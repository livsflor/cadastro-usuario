<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Cadastro de Músicas</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>Cadastro de Músicas</h1>

<!-- Criar música -->
<h2>Criar</h2>
<input type="text" id="titulo" placeholder="Título da música">
<input type="text" id="artista" placeholder="Artista">
<button onclick="criar()">Salvar</button>

<hr>

<!-- Buscar música -->
<h2>Buscar</h2>
<input type="text" id="buscarTitulo" placeholder="Título da música">
<button onclick="buscar()">Buscar</button>
<pre id="resultadoBuscar"></pre>

<hr>

<!-- Deletar música -->
<h2>Deletar</h2>
<input type="text" id="deletarTitulo" placeholder="Título da música">
<button onclick="deletar()">Deletar</button>

<hr>

<!-- Atualizar música -->
<h2>Atualizar</h2>
<input type="number" id="id" placeholder="ID">
<input type="text" id="novoTitulo" placeholder="Novo Título">
<input type="text" id="novoArtista" placeholder="Novo Artista">
<button onclick="atualizar()">Atualizar</button>

<script>
    const api = "/musica";

    async function criar() {
        const resp = await fetch(api, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                titulo: document.getElementById("titulo").value,
                artista: document.getElementById("artista").value
            })
        });
        alert(resp.ok ? "Música criada!" : "Erro ao criar!");
    }

    async function buscar() {
        const titulo = document.getElementById("buscarTitulo").value;
        const resp = await fetch(`${api}?titulo=${encodeURIComponent(titulo)}`);
        if (resp.ok) {
            const data = await resp.json();
            document.getElementById("resultadoBuscar").innerText = JSON.stringify(data, null, 2);
        } else {
            document.getElementById("resultadoBuscar").innerText = "Música não encontrada!";
        }
    }

    async function deletar() {
        const titulo = document.getElementById("deletarTitulo").value;
        const resp = await fetch(`${api}?titulo=${encodeURIComponent(titulo)}`, { method: "DELETE" });
        alert(resp.ok ? "Música deletada!" : "Erro ao deletar!");
    }

    async function atualizar() {
        const id = document.getElementById("id").value;
        const resp = await fetch(`${api}?id=${id}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                titulo: document.getElementById("novoTitulo").value,
                artista: document.getElementById("novoArtista").value
            })
        });
        alert(resp.ok ? "Música atualizada!" : "Erro ao atualizar!");
    }
</script>

</body>
</html>
